{
  "name": "D_Date_DynamicPeriods-bfc5972f-5f13-46e8-9aa1-04cae1df6f59",
  "mode": "import",
  "source": {
    "type": "calculated",
    "expression": [
      "",
      "VAR Yesterday = TODAY() -1",
      "VAR ThisYearFirstDate = Date(year(today()),1,1)",
      "VAR ThisYearLastDate = if(Date(year(today()),12,31) > Yesterday, (Date(year(today()),12,31)))",
      "VAR LastYearFirstDate =FIRSTDATE(PARALLELPERIOD(FILTER(ALL(D_Date_Shadow[Date_Date]),D_Date_Shadow[Date_Date]=today()),-1,YEAR))",
      "VAR LastYearLastDate = LASTDATE(PARALLELPERIOD(FILTER(ALL(D_Date_Shadow[Date_Date]),D_Date_Shadow[Date_Date]=today()),-1,YEAR))",
      "VAR Last7DaysFirstDate = DATE(Year(today()),month(today()),day(today()))-7",
      "VAR Last7DaysLastDate = DATE(Year(today()),month(today()),day(today()))-1",
      "VAR Last30DaysFirstDate = DATE(Year(today()),month(today()),day(today()))-30",
      "VAR Last30DaysLastDate = DATE(Year(today()),month(today()),day(today()))-1",
      "VAR ThisMonthFirstDate =  DATE(Year(today()),month(today()),1)",
      "VAR ThisMonthLastDate = CALCULATE(ENDOFMONTH(D_Date_Shadow[Date_Date]), FILTER(ALL(D_Date_Shadow[Date_Date]),D_Date_Shadow[Date_Date]=today()))",
      "VAR LastMonthFirstDate= FIRSTDATE(PARALLELPERIOD(FILTER(ALL(D_Date_Shadow[Date_Date]),D_Date_Shadow[Date_Date]=today()),-1,MONTH))",
      "VAR LastMonthLastDate= LASTDATE(PARALLELPERIOD(FILTER(ALL(D_Date_Shadow[Date_Date]),D_Date_Shadow[Date_Date]=today()),-1,MONTH))",
      "VAR FirstMonthFirstDate= Date(year(today()),1,1)",
      "VAR FirstMonthLastDate= Date(year(today()),1,31)",
      "VAR SecondMonthFirstDate= Date(year(today()),2,1)",
      "VAR SecondMonthLastDate= Date(year(today()),2,29)",
      "VAR ThirdMonthFirstDate= Date(year(today()),3,1)",
      "VAR ThirdMonthLastDate= Date(year(today()),3,31)",
      "VAR FourthMonthFirstDate= Date(year(today()),4,1)",
      "VAR FourthMonthLastDate= Date(year(today()),4,30)",
      "VAR FifthMonthFirstDate= Date(year(today()),5,1)",
      "VAR FifthMonthLastDate= Date(year(today()),5,31)",
      "VAR SixthMonthFirstDate= Date(year(today()),6,1)",
      "VAR SixthMonthLastDate= Date(year(today()),6,30)",
      "VAR SeventhMonthFirstDate= Date(year(today()),7,1)",
      "VAR SeventhMonthLastDate= Date(year(today()),7,31)",
      "VAR EighthMonthFirstDate= Date(year(today()),8,1)",
      "VAR EighthMonthLastDate= Date(year(today()),8,31)",
      "VAR NinethMonthFirstDate= Date(year(today()),9,1)",
      "VAR NinethMonthLastDate= Date(year(today()),9,30)",
      "VAR TenthMonthFirstDate= Date(year(today()),10,1)",
      "VAR TenthMonthLastDate= Date(year(today()),10,31)",
      "VAR EleventhMonthFirstDate= Date(year(today()),11,1)",
      "VAR EleventhMonthLastDate= Date(year(today()),11,30)",
      "VAR TwelvethMonthFirstDate= Date(year(today()),12,1)",
      "VAR TwelvethMonthLastDate= Date(year(today()),12,31)",
      "",
      "VAR ThisQuarterFirstDate = CALCULATE(STARTOFQUARTER(D_Date_Shadow[Date_Date]), FILTER(ALL(D_Date_Shadow[Date_Date]),D_Date_Shadow[Date_Date]=today()))",
      "VAR ThisQuarterLastDate = CALCULATE(ENDOFQUARTER(D_Date_Shadow[Date_Date]), FILTER(ALL(D_Date_Shadow[Date_Date]),D_Date_Shadow[Date_Date]=today()))",
      "VAR LastQuarterFirstDate= FIRSTDATE(PARALLELPERIOD(FILTER(ALL(D_Date_Shadow[Date_Date]),D_Date_Shadow[Date_Date]=today()),-1,QUARTER))",
      "VAR LastQuarterLastDate= LASTDATE(PARALLELPERIOD(FILTER(ALL(D_Date_Shadow[Date_Date]),D_Date_Shadow[Date_Date]=today()),-1,QUARTER))",
      "",
      "VAR FirstQuarterFirstDate= Date(year(today()),1,1)",
      "VAR FirstQuarterLastDate= Date(year(today()),3,31)",
      "",
      "VAR SecondQuarterFirstDate= Date(year(today()),4,1)",
      "VAR SecondQuarterLastDate= Date(year(today()),6,30)",
      "",
      "VAR ThirdQuarterFirstDate= Date(year(today()),7,1)",
      "VAR ThirdQuarterLastDate= Date(year(today()),9,30)",
      "",
      "VAR FourthQuarterFirstDate= Date(year(today()),10,1)",
      "VAR FourthQuarterLastDate= Date(year(today()),12,31)",
      "",
      "--VAR Corona1 = DATE(2020 ,03 ,12)",
      "--VAR Corona2 = DATE(2020 ,03 ,17)",
      "--VAR Feb = DATE(2020 , 02 , 01)",
      "--VAR Mrt = DATE(2020 , 03 , 01)",
      "--VAR Apr = DATE(2020 , 04 , 01)",
      "--VAR MIN_Custom = CALCULATE(MIN(Z_TimeSlice_Custom[Date]), USERELATIONSHIP(Z_TimeSlice_Custom[Date],D_Date_Shadow[Date_Date]))",
      "--VAR MAX_Custom = CALCULATE(MAX(Z_TimeSlice_Custom[Date]), USERELATIONSHIP(Z_TimeSlice_Custom[Date],D_Date_Shadow[Date_Date]))",
      "--VAR YearStart = CALCULATE(STARTOFYEAR(F_Inventory[Date_Date]), YEAR(F_Inventory[Date_Date]) = YEAR(TodayDate) )",
      "--VAR YearEnd = CALCULATE(ENDOFYEAR(F_Inventory[Date_Date]), YEAR(F_Inventory[Date_Date]) = YEAR(TodayDate) )",
      "--VAR QuarterStart = CALCULATE(STARTOFQUARTER(F_Inventory[Date_Date]), YEAR(F_Inventory[Date_Date]) = YEAR(TodayDate), QUARTER(F_Inventory[Date_Date]) = QUARTER(TodayDate) )",
      "--VAR MonthStart = CALCULATE(STARTOFMONTH(F_Inventory[Date_Date]), YEAR(F_Inventory[Date_Date]) = YEAR(TodayDate), MONTH(F_Inventory[Date_Date]) = MONTH(TodayDate) )",
      "",
      "VAR Result = ",
      "UNION (",
      "    ADDCOLUMNS (",
      "        CALENDAR ( Yesterday, TODAY() ),",
      "        \"Period\", \"Yesterday\",",
      "        \"Sorting\",1,",
      "        \"Period_Level2\", \"Yesterday\",",
      "        \"Sorting_Level2\", Date(year([Date]),Month([Date]),Day([Date])) --Day([Date]) & \"-\"  & Month([Date]) & \"-\" & year([Date])",
      "    ),",
      "    ADDCOLUMNS (",
      "        CALENDAR (Last7DaysFirstDate, Last7DaysLastDate ),",
      "        \"Period\", \"Last 7 Days\",",
      "        \"Sorting\",2,",
      "        \"Period_Level2\",Day([Date]) & \"-\"  & Month([Date]) & \"-\" & year([Date]),",
      "        \"Sorting_Level2\", Date(year([Date]),Month([Date]),Day([Date])) -- Day([Date]) & \"-\"  & Month([Date]) & \"-\" & year([Date])",
      "    ),",
      "    ADDCOLUMNS (",
      "        CALENDAR ( Last30DaysFirstDate, Last30DaysLastDate ),",
      "        \"Period\", \"Last 30 Days\",",
      "        \"Sorting\",3,",
      "        \"Period_Level2\",Day([Date]) & \"-\"  & Month([Date]) & \"-\" & year([Date]),",
      "        \"Sorting_Level2\", Date(year([Date]),Month([Date]),Day([Date])) --Day([Date]) & \"-\"  & Month([Date]) & \"-\" & year([Date])",
      "    ),",
      "",
      "    ADDCOLUMNS (",
      "        CALENDAR ( ThisMonthFirstDate, ThisMonthLastDate ),",
      "        \"Period\", \"This Month\",",
      "        \"Sorting\",4,",
      "        \"Period_Level2\",Day([Date]) & \"-\"  & Month([Date]) & \"-\" & year([Date]),",
      "        \"Sorting_Level2\", Date(year([Date]),Month([Date]),Day([Date])) --Day([Date]) & \"-\"  & Month([Date]) & \"-\" & year([Date])",
      "",
      "    ),",
      "",
      "    ADDCOLUMNS (",
      "        CALENDAR ( LastMonthFirstDate, LastMonthLastDate ),",
      "        \"Period\", \"Last Month\",",
      "        \"Sorting\",5,",
      "        \"Period_Level2\",Day([Date]) & \"-\"  & Month([Date]) & \"-\" & year([Date]),",
      "        \"Sorting_Level2\", Date(year([Date]),Month([Date]),Day([Date])) --Day([Date]) & \"-\"  & Month([Date]) & \"-\" & year([Date])",
      "",
      "    ),",
      "",
      "",
      "    ",
      "",
      "    ADDCOLUMNS (",
      "        CALENDAR ( ThisQuarterFirstDate, ThisQuarterLastDate ),",
      "        \"Period\", \"This Quarter\",",
      "        \"Sorting\",6,",
      "        \"Period_Level2\",LOOKUPVALUE(D_Date_Shadow[Date_Month-Name],D_Date_Shadow[Date_Month],Month([Date])),",
      "        \"Sorting_Level2\",Date(year([Date]),Month([Date]),1) --MONTH([Date])",
      "",
      "    ),",
      "    ADDCOLUMNS (",
      "        CALENDAR ( LastQuarterFirstDate, LastQuarterLastDate ),",
      "        \"Period\", \"Last Quarter\",",
      "        \"Sorting\",7,",
      "        \"Period_Level2\",LOOKUPVALUE(D_Date_Shadow[Date_Month-Name],D_Date_Shadow[Date_Month],Month([Date])),",
      "        \"Sorting_Level2\", Date(year([Date]),Month([Date]),1) --MONTH([Date])",
      "    ),",
      "",
      "    ADDCOLUMNS (",
      "        CALENDAR ( ThisYearFirstDate, ThisYearLastDate ),",
      "        \"Period\", \"This Year\",",
      "        \"Sorting\",8,",
      "        \"Period_Level2\",LOOKUPVALUE(D_Date_Shadow[Date_Month-Name],D_Date_Shadow[Date_Month],Month([Date])),",
      "        \"Sorting_Level2\", Date(year([Date]),Month([Date]),1) --MONTH([Date])",
      "    ), ",
      "",
      "    ADDCOLUMNS (",
      "        CALENDAR ( LastYearFirstDate, LastYearLastDate ),",
      "        \"Period\", \"Last Year\",",
      "        \"Sorting\",9,",
      "        \"Period_Level2\",LOOKUPVALUE(D_Date_Shadow[Date_Month-Name],D_Date_Shadow[Date_Month],Month([Date])),",
      "        \"Sorting_Level2\", Date(year([Date]),Month([Date]),1) --MONTH([Date])",
      "    ), ",
      "    ADDCOLUMNS (",
      "        CALENDAR ( FirstQuarterFirstDate, FirstQuarterLastDate ),",
      "        \"Period\", \"Q1\",",
      "        \"Sorting\",10,",
      "        \"Period_Level2\",LOOKUPVALUE(D_Date_Shadow[Date_Month-Name],D_Date_Shadow[Date_Month],Month([Date])),",
      "        \"Sorting_Level2\", Date(year([Date]),Month([Date]),1) --MONTH([Date])",
      "    ),",
      "",
      "    ADDCOLUMNS (",
      "        CALENDAR ( SecondQuarterFirstDate, SecondQuarterLastDate ),",
      "        \"Period\", \"Q2\",",
      "        \"Sorting\",11,",
      "        \"Period_Level2\",LOOKUPVALUE(D_Date_Shadow[Date_Month-Name],D_Date_Shadow[Date_Month],Month([Date])),",
      "        \"Sorting_Level2\", Date(year([Date]),Month([Date]),1) --MONTH([Date])",
      "    ),",
      "",
      "",
      "    ADDCOLUMNS (",
      "        CALENDAR ( ThirdQuarterFirstDate, ThirdQuarterLastDate ),",
      "        \"Period\", \"Q3\",",
      "        \"Sorting\",12,",
      "        \"Period_Level2\",LOOKUPVALUE(D_Date_Shadow[Date_Month-Name],D_Date_Shadow[Date_Month],Month([Date])),",
      "        \"Sorting_Level2\", Date(year([Date]),Month([Date]),1) --MONTH([Date])",
      "    ),",
      "",
      "    ADDCOLUMNS (",
      "        CALENDAR ( FourthQuarterFirstDate, FourthQuarterLastDate ),",
      "        \"Period\", \"Q4\",",
      "        \"Sorting\",13,",
      "        \"Period_Level2\",LOOKUPVALUE(D_Date_Shadow[Date_Month-Name],D_Date_Shadow[Date_Month],Month([Date])),",
      "        \"Sorting_Level2\", Date(year([Date]),Month([Date]),1) --MONTH([Date])",
      "    )",
      "",
      "",
      "/*",
      "",
      "    ADDCOLUMNS (",
      "        CALENDAR ( FirstMonthFirstDate, FirstMonthLastDate ),",
      "        \"Period\", \"M1\",",
      "        \"Sorting\",13,",
      "         \"Period_Level2\",Day([Date]) & \"-\"  & Month([Date]) & \"-\" & year([Date]),",
      "        \"Sorting_Level2\", Date(year([Date]),Month([Date]),Day([Date])) --Day([Date]) & \"-\"  & Month([Date]) & \"-\" & year([Date])",
      "    ),",
      "",
      "    ADDCOLUMNS (",
      "        CALENDAR ( SecondMonthFirstDate, SecondMonthLastDate ),",
      "        \"Period\", \"M2\",",
      "        \"Sorting\",14,",
      "        \"Period_Level2\",Day([Date]) & \"-\"  & Month([Date]) & \"-\" & year([Date]),",
      "        \"Sorting_Level2\", Date(year([Date]),Month([Date]),Day([Date])) --Day([Date]) & \"-\"  & Month([Date]) & \"-\" & year([Date])",
      "    ),",
      "",
      "    ADDCOLUMNS (",
      "        CALENDAR ( ThirdMonthFirstDate, ThirdMonthLastDate ),",
      "        \"Period\", \"M3\",",
      "        \"Sorting\",15,",
      "        \"Period_Level2\",Day([Date]) & \"-\"  & Month([Date]) & \"-\" & year([Date]),",
      "        \"Sorting_Level2\", Date(year([Date]),Month([Date]),Day([Date])) --Day([Date]) & \"-\"  & Month([Date]) & \"-\" & year([Date])",
      "    ),",
      "",
      "    ADDCOLUMNS (",
      "        CALENDAR ( FourthMonthFirstDate, FourthMonthLastDate ),",
      "        \"Period\", \"M4\",",
      "        \"Sorting\",16,",
      "        \"Period_Level2\",Day([Date]) & \"-\"  & Month([Date]) & \"-\" & year([Date]),",
      "        \"Sorting_Level2\", Date(year([Date]),Month([Date]),Day([Date])) --Day([Date]) & \"-\"  & Month([Date]) & \"-\" & year([Date])",
      "    ),",
      "",
      "    ADDCOLUMNS (",
      "        CALENDAR ( FifthMonthFirstDate, FifthMonthLastDate ),",
      "        \"Period\", \"M5\",",
      "        \"Sorting\",17,",
      "        \"Period_Level2\",Day([Date]) & \"-\"  & Month([Date]) & \"-\" & year([Date]),",
      "        \"Sorting_Level2\", Date(year([Date]),Month([Date]),Day([Date])) --Day([Date]) & \"-\"  & Month([Date]) & \"-\" & year([Date])",
      "    ),",
      "",
      "    ADDCOLUMNS (",
      "        CALENDAR ( SixthMonthFirstDate, SixthMonthLastDate ),",
      "        \"Period\", \"M6\",",
      "        \"Sorting\",18,",
      "        \"Period_Level2\",Day([Date]) & \"-\"  & Month([Date]) & \"-\" & year([Date]),",
      "        \"Sorting_Level2\", Date(year([Date]),Month([Date]),Day([Date])) --Day([Date]) & \"-\"  & Month([Date]) & \"-\" & year([Date])",
      "    ),",
      "",
      "    ADDCOLUMNS (",
      "        CALENDAR ( SeventhMonthFirstDate,SeventhMonthLastDate ),",
      "        \"Period\", \"M7\",",
      "        \"Sorting\",18,",
      "        \"Period_Level2\",Day([Date]) & \"-\"  & Month([Date]) & \"-\" & year([Date]),",
      "        \"Sorting_Level2\", Date(year([Date]),Month([Date]),Day([Date])) --Day([Date]) & \"-\"  & Month([Date]) & \"-\" & year([Date])",
      "    ),",
      "",
      "    ADDCOLUMNS (",
      "        CALENDAR ( EighthMonthFirstDate, EighthMonthLastDate ),",
      "        \"Period\", \"M8\",",
      "        \"Sorting\",19,",
      "        \"Period_Level2\",Day([Date]) & \"-\"  & Month([Date]) & \"-\" & year([Date]),",
      "        \"Sorting_Level2\", Date(year([Date]),Month([Date]),Day([Date])) --Day([Date]) & \"-\"  & Month([Date]) & \"-\" & year([Date])",
      "    ),",
      "",
      "    ADDCOLUMNS (",
      "        CALENDAR ( NinethMonthFirstDate, NinethMonthLastDate ),",
      "        \"Period\", \"M9\",",
      "        \"Sorting\",20,",
      "        \"Period_Level2\",Day([Date]) & \"-\"  & Month([Date]) & \"-\" & year([Date]),",
      "        \"Sorting_Level2\", Date(year([Date]),Month([Date]),Day([Date])) --Day([Date]) & \"-\"  & Month([Date]) & \"-\" & year([Date])",
      "    ),",
      "",
      "    ADDCOLUMNS (",
      "        CALENDAR ( TenthMonthFirstDate, TenthMonthLastDate ),",
      "        \"Period\", \"M10\",",
      "        \"Sorting\",21,",
      "        \"Period_Level2\",Day([Date]) & \"-\"  & Month([Date]) & \"-\" & year([Date]),",
      "        \"Sorting_Level2\", Date(year([Date]),Month([Date]),Day([Date])) --Day([Date]) & \"-\"  & Month([Date]) & \"-\" & year([Date])",
      "    ),",
      "",
      "    ADDCOLUMNS (",
      "        CALENDAR (EleventhMonthFirstDate, EleventhMonthLastDate ),",
      "        \"Period\", \"M11\",",
      "        \"Sorting\",22,",
      "        \"Period_Level2\",Day([Date]) & \"-\"  & Month([Date]) & \"-\" & year([Date]),",
      "        \"Sorting_Level2\", Date(year([Date]),Month([Date]),Day([Date])) --Day([Date]) & \"-\"  & Month([Date]) & \"-\" & year([Date])",
      "    ),",
      "",
      "    ADDCOLUMNS (",
      "        CALENDAR ( TwelvethMonthFirstDate, TwelvethMonthLastDate ),",
      "        \"Period\", \"M12\",",
      "        \"Sorting\",23,",
      "        \"Period_Level2\",Day([Date]) & \"-\"  & Month([Date]) & \"-\" & year([Date]),",
      "        \"Sorting_Level2\", Date(year([Date]),Month([Date]),Day([Date])) --Day([Date]) & \"-\"  & Month([Date]) & \"-\" & year([Date])",
      "    )",
      "",
      "*/",
      "",
      "",
      "",
      "   ",
      ")",
      "RETURN",
      "Result"
    ]
  }
}